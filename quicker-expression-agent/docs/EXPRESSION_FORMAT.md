# 表达式格式说明

## 新格式设计

为了避免 `{var}` 这种语法问题，我们采用了一种新的表达式格式，将变量声明和实际表达式内容分离。

### 格式结构

```
变量声明部分（标准C#语法）
////-------分隔符-------////
实际表达式内容（使用 {变量名} 引用变量）
```

### 示例

```csharp
var name = "";
var age = 0;
var items = new List<string>(){"hhh"};
////-------分隔符-------////
name + " is " + age + " years old"
```

### 变量声明规则

1. **字符串类型**：使用空字符串作为默认值
   ```csharp
   var a = "";
   ```

2. **数值类型**：使用 0 作为默认值
   ```csharp
   var count = 0;
   var price = 0.0;
   ```

3. **布尔类型**：使用 false 作为默认值
   ```csharp
   var isActive = false;
   ```

4. **集合类型**：使用带初始值的构造函数
   ```csharp
   var items = new List<string>(){"hhh"};
   var numbers = new int[]{1, 2, 3};
   ```

5. **对象类型**：使用 new 关键字
   ```csharp
   var person = new { Name = "", Age = 0 };
   ```

### 表达式部分

在分隔符之后，使用 `{变量名}` 来引用在变量声明部分定义的变量，或者引用来自 Quicker 上下文的变量。

```csharp
////-------分隔符-------////
{name} + " is " + {age} + " years old"
```

### 解析过程

1. **分割**：根据分隔符 `////-------分隔符-------////` 分割代码
2. **变量声明**：保留变量声明部分
3. **变量替换**：在表达式部分，将 `{变量名}` 替换为实际的变量名
4. **合并**：将变量声明和替换后的表达式合并为完整的可执行代码

### 完整示例

**输入（生成的表达式）：**
```csharp
var name = "";
var age = 0;
////-------分隔符-------////
{name} + " is " + {age} + " years old"
```

**解析后（可执行代码）：**
```csharp
var name = "";
var age = 0;
name + " is " + age + " years old"
```

### 优势

1. ✅ **标准语法**：变量声明使用标准C#语法，LLM更容易生成
2. ✅ **清晰分离**：变量声明和表达式内容明确分离
3. ✅ **易于解析**：分隔符清晰，便于程序解析
4. ✅ **避免语法错误**：不会出现 `{var}` 这种不合法语法
5. ✅ **灵活扩展**：可以轻松添加更多变量声明

### 注意事项

- 如果没有分隔符，整个代码会被当作简单表达式处理
- 变量声明部分可以为空（只有分隔符和表达式）
- 表达式中的 `{变量名}` 会优先匹配变量声明中的变量，然后是 Quicker 上下文变量

