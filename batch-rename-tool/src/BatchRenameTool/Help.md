# 批量重命名工具 - 使用帮助

## 基本使用

1. **添加文件**：点击"选择文件夹"选择文件夹，或点击"添加文件"选择多个文件，或点击"粘贴文件"从剪贴板粘贴文件列表。

2. 文件列表会自动加载到预览窗口中，以表格形式显示重命名前后的文件名对比。

3. 在"重命名模式"输入框中输入重命名规则（可选）。输入 `{` 可查看可用变量，输入 `.` 可查看可用方法。

4. 预览重命名结果，确认无误后点击"执行重命名"按钮完成批量重命名。

5. **撤销操作**：点击"撤销"按钮可撤销上一次重命名操作。

## 变量

### 字符串变量

- `{name}` - 原文件名（不含扩展名）
- `{ext}` - 文件扩展名（不含点号）
- `{fullname}` - 完整文件名（包含扩展名）

### 序号变量

- `{i}` - 序号，从0开始。支持格式：`{i:00}`, `{i:01}`, `{i:1}`, `{i:零}`, `{i:一}`, `{i:壹}` 等
- `{iv}` - 倒序序号，从最后一个开始倒序。格式同 `{i}`

### 日期时间变量

- `{today}` - 当前日期。格式：`{today:yyyy-MM-dd}`, `{today:yyyy年MM月dd日}` 等
- `{now}` - 当前日期时间。格式：`{now:yyyyMMddHHmmss}`, `{now:yyyy年MM月dd日 HH时mm分}` 等

> **注意**：文件名不支持冒号，日期时间格式中不要使用冒号

## 格式语法

使用冒号 `:` 为变量指定格式：

- `{i:00}` - 2位数字，从00开始
- `{i:001}` - 3位数字，从001开始
- `{today:yyyy-MM-dd}` - 日期格式：2024-01-01
- `{now:yyyyMMddHHmmss}` - 日期时间格式：20240101123045

### 序号变量支持表达式

- `{i:2*i+1:000}` - 序号乘以2加1，3位数字格式
- `{i:i*3-2:00}` - 序号乘以3减2，2位数字格式

## 字符串方法

字符串变量支持方法调用，使用点号 `.` 访问方法：

### replace / 替换

- `{name.replace(old,new)}` - 替换字符串

### upper / 大写

- `{name.upper}` 或 `{name.upper()}` - 转换为大写

### lower / 小写

- `{name.lower}` 或 `{name.lower()}` - 转换为小写

### trim / 去空格

- `{name.trim}` 或 `{name.trim()}` - 去除首尾空格

### sub / 截取 / 切片

- `{name.sub(start)}` 或 `{name.sub(start,end)}` 或 `{name[start:end]}` - 截取字符串

### padLeft / 左填充

- `{name.padLeft(10)}` 或 `{name.padLeft(10,0)}` - 左侧填充

### padRight / 右填充

- `{name.padRight(10)}` 或 `{name.padRight(10,-)}` - 右侧填充

### 链式调用

方法支持链式调用：`{name.upper.replace(_,-)}` - 先转大写，再替换下划线为短横线

## 示例

- 模式：`{name}_backup.{ext}` → 将 `file.txt` 重命名为 `file_backup.txt`
- 模式：`New_{fullname}` → 将 `file.txt` 重命名为 `New_file.txt`
- 模式：`{i:00}_{name}.{ext}` → 添加序号前缀，如 `00_file.txt`
- 模式：`{name.upper.replace(_,-)}.{ext}` → 转大写并替换下划线，如 `MY-FILE.txt`
- 留空模式 → 保持原文件名不变（不添加 New_ 前缀）

## 功能特性

- **表格预览**：以表格形式显示重命名前后的文件名，方便对比查看
- **高亮显示**：重命名后的文件名会以粗体显示，便于识别变化
- **多选支持**：支持单选和多选，按住 Ctrl 键点击多个项，或按住 Shift 键选择范围
- **实时预览**：修改重命名模式后实时更新预览结果
- **智能补全**：输入 `{` 显示变量列表，输入 `.` 显示方法列表，输入 `:` 显示格式选项
- **状态栏**：实时显示文件总数、已改变数量、未改变数量、重复名称等信息
- **撤销功能**：支持撤销上一次重命名操作

## 使用技巧

- 在预览列表中，可以拖动列标题调整列宽
- 使用键盘方向键可以在列表中导航
- 如果重命名后的文件名已存在，该文件会被跳过并显示错误信息
- 重命名操作支持撤销，但请谨慎操作
- 可以从剪贴板粘贴文件列表（支持文本格式或文件拖放列表格式）
- 支持排除选中的文件，方便批量移除不需要的文件
