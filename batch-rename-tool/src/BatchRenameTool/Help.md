# 批量重命名工具 - 使用帮助

## 基本使用

1. **添加文件**：点击"选择文件夹"选择文件夹，或点击"添加文件"选择多个文件，或点击"粘贴文件"从剪贴板粘贴文件列表。

2. 文件列表会自动加载到预览窗口中，以表格形式显示重命名前后的文件名对比。

3. 在"重命名模式"输入框中输入重命名规则（可选）。输入 `{` 可查看可用变量，输入 `.` 可查看可用方法。

4. 预览重命名结果，确认无误后点击"执行重命名"按钮完成批量重命名。

5. **撤销操作**：点击"撤销"按钮可撤销上一次重命名操作。

## 变量

### 字符串变量

- `{name}` - 原文件名（不含扩展名）
- `{ext}` - 文件扩展名（不含点号）
- `{fullname}` - 完整文件名（包含扩展名）

### 序号变量

- `{i}` - 序号，从0开始。支持格式：`{i:00}`, `{i:01}`, `{i:1}`, `{i:零}`, `{i:一}`, `{i:壹}` 等
- `{iv}` - 倒序序号，从最后一个开始倒序。格式同 `{i}`

### 日期时间变量

- `{today}` - 当前日期。格式：`{today:yyyy-MM-dd}`, `{today:yyyy年MM月dd日}` 等
- `{now}` - 当前日期时间。格式：`{now:yyyyMMddHHmmss}`, `{now:yyyy年MM月dd日 HH时mm分}` 等

> **注意**：文件名不支持冒号，日期时间格式中不要使用冒号

## 格式语法

使用冒号 `:` 为变量指定格式：

- `{i:00}` - 2位数字，从00开始
- `{i:001}` - 3位数字，从001开始
- `{today:yyyy-MM-dd}` - 日期格式：2024-01-01
- `{now:yyyyMMddHHmmss}` - 日期时间格式：20240101123045

### 序号变量支持表达式

- `{i:2*i+1:000}` - 序号乘以2加1，3位数字格式
- `{i:i*3-2:00}` - 序号乘以3减2，2位数字格式

## 字符串方法

字符串变量支持方法调用，使用点号 `.` 访问方法：

### replace / 替换

- `{name.replace(old,new)}` - 替换字符串

### upper / 大写

- `{name.upper}` 或 `{name.upper()}` - 转换为大写

### lower / 小写

- `{name.lower}` 或 `{name.lower()}` - 转换为小写

### trim / 去空格

- `{name.trim}` 或 `{name.trim()}` - 去除首尾空格

### sub / 截取 / 切片

字符串截取是重命名中非常常用的功能，支持两种语法形式：

#### 语法糖形式 `[a:b]`（推荐）

`[a:b]` 是 `sub()` 方法的简洁写法，更直观易用：

- `{name[:3]}` - 截取前3个字符（从开始到索引3，不包含3）
  - 示例：`file.txt` → `fil`
- `{name[3:]}` - 从索引3开始截取到末尾
  - 示例：`file.txt` → `e.txt`
- `{name[1:4]}` - 从索引1截取到索引4（不包含4）
  - 示例：`file.txt` → `ile`
- `{name[:]}` - 完整字符串（等同于 `{name}`）
  - 示例：`file.txt` → `file.txt`

**索引说明**：
- 索引从 0 开始计数
- `[a:b]` 表示从索引 `a` 到索引 `b`（不包含 `b`）
- `[:b]` 表示从开始到索引 `b`（不包含 `b`）
- `[a:]` 表示从索引 `a` 到末尾

#### 方法调用形式 `sub()`

- `{name.sub(start)}` - 从 `start` 开始截取到末尾
- `{name.sub(start,end)}` - 从 `start` 截取到 `end`（不包含 `end`）

**语法糖转换规则**：
- `{name[:b]}` 等同于 `{name.sub(0,b)}`
- `{name[a:]}` 等同于 `{name.sub(a)}`
- `{name[a:b]}` 等同于 `{name.sub(a,b)}`
- `{name[:]}` 等同于 `{name}`

**实际应用场景**：
- 截取文件名前缀：`{name[:5]}` 获取前5个字符
- 去除文件名前缀：`{name[3:]}` 跳过前3个字符
- 提取中间部分：`{name[2:6]}` 提取索引2到6之间的字符

### padLeft / 左填充

- `{name.padLeft(10)}` 或 `{name.padLeft(10,0)}` - 左侧填充

### padRight / 右填充

- `{name.padRight(10)}` 或 `{name.padRight(10,-)}` - 右侧填充

### 链式调用

方法支持链式调用：`{name.upper.replace(_,-)}` - 先转大写，再替换下划线为短横线

## 示例

### 基础重命名示例

- 模式：`{name}_backup.{ext}` → 将 `file.txt` 重命名为 `file_backup.txt`
- 模式：`New_{fullname}` → 将 `file.txt` 重命名为 `New_file.txt`
- 模式：`{i:00}_{name}.{ext}` → 添加序号前缀，如 `00_file.txt`
- 模式：`{name.upper.replace(_,-)}.{ext}` → 转大写并替换下划线，如 `MY-FILE.txt`
- 留空模式 → 保持原文件名不变（不添加 New_ 前缀）

### 字符串截取 `[a:b]` 示例（重点）

字符串截取是批量重命名中最常用的功能之一，以下是一些典型应用场景：

#### 示例1：截取文件名前缀
- **模式**：`{name[:5]}_{i:00}.{ext}`
- **原文件名**：`document.txt`, `picture.jpg`, `archive.zip`
- **结果**：`docum_00.txt`, `pictu_01.jpg`, `archi_02.zip`
- **说明**：截取前5个字符，然后添加序号

#### 示例2：去除文件名前缀
- **模式**：`{name[4:]}.{ext}`
- **原文件名**：`IMG_photo.jpg`, `IMG_landscape.png`, `IMG_portrait.gif`
- **结果**：`photo.jpg`, `landscape.png`, `portrait.gif`
- **说明**：跳过前4个字符（`IMG_`），保留后面的文件名

#### 示例3：提取中间部分
- **模式**：`{name[2:6]}_{i:00}.{ext}`
- **原文件名**：`20240101_report.pdf`, `20240102_data.xlsx`, `20240103_summary.docx`
- **结果**：`2401_00.pdf`, `2401_01.xlsx`, `2401_02.docx`
- **说明**：提取索引2到6之间的字符（年份的后两位和月份）

#### 示例4：截取并组合
- **模式**：`{name[:3]}_{name[3:]}.{ext}`
- **原文件名**：`ABC123file.txt`, `XYZ456data.csv`
- **结果**：`ABC_123file.txt`, `XYZ_456data.csv`
- **说明**：将文件名分为两部分，中间用下划线连接

#### 示例5：截取后添加序号
- **模式**：`{name[:8]}_{i:000}.{ext}`
- **原文件名**：`longfilename1.txt`, `longfilename2.txt`, `longfilename3.txt`
- **结果**：`longfile_000.txt`, `longfile_001.txt`, `longfile_002.txt`
- **说明**：截取前8个字符，然后添加3位序号

#### 示例6：截取与替换组合
- **模式**：`{name[:10].replace(_,-)}.{ext}`
- **原文件名**：`file_name_with_underscores.txt`
- **结果**：`file-name-.txt`
- **说明**：先截取前10个字符，再将下划线替换为短横线

#### 示例7：从指定位置截取到末尾
- **模式**：`{name[7:]}.{ext}`
- **原文件名**：`prefix_filename.txt`, `prefix_document.pdf`
- **结果**：`filename.txt`, `document.pdf`
- **说明**：跳过前7个字符（`prefix_`），保留后面的内容

#### 示例8：处理日期格式文件名
- **模式**：`{name[4:6]}-{name[6:8]}-{name[8:10]}_{name[11:]}.{ext}`
- **原文件名**：`20240115_report.txt`, `20240220_data.csv`
- **结果**：`01-15-report.txt`, `02-20-data.csv`
- **说明**：将 `YYYYMMDD` 格式转换为 `MM-DD` 格式，并保留后面的文件名

#### 示例9：截取与大小写转换
- **模式**：`{name[:4].upper}_{name[4:]}.{ext}`
- **原文件名**：`testfile.txt`, `demo123.txt`
- **结果**：`TEST_file.txt`, `DEMO_123.txt`
- **说明**：前4个字符转大写，后面保持原样，中间用下划线连接

#### 示例10：去除文件名后缀并添加新后缀
- **模式**：`{name[:7]}_new.{ext}`
- **原文件名**：`oldfile_backup.txt`, `document_old.pdf`
- **结果**：`oldfile_new.txt`, `document_new.pdf`
- **说明**：截取前7个字符（去除 `_backup` 或 `_old` 后缀），然后添加 `_new` 后缀

> **提示**：如果只是想在文件名后添加后缀，可以直接使用 `{name}_new.{ext}`，无需截取。

> **提示**：`[a:b]` 语法非常灵活，可以与其他方法组合使用，实现复杂的重命名需求。在实际使用中，建议先预览结果，确认截取位置是否正确。

## 功能特性

- **表格预览**：以表格形式显示重命名前后的文件名，方便对比查看
- **高亮显示**：重命名后的文件名会以粗体显示，便于识别变化
- **多选支持**：支持单选和多选，按住 Ctrl 键点击多个项，或按住 Shift 键选择范围
- **实时预览**：修改重命名模式后实时更新预览结果
- **智能补全**：输入 `{` 显示变量列表，输入 `.` 显示方法列表，输入 `:` 显示格式选项
- **状态栏**：实时显示文件总数、已改变数量、未改变数量、重复名称等信息
- **撤销功能**：支持撤销上一次重命名操作

## 使用技巧

- 在预览列表中，可以拖动列标题调整列宽
- 使用键盘方向键可以在列表中导航
- 如果重命名后的文件名已存在，该文件会被跳过并显示错误信息
- 重命名操作支持撤销，但请谨慎操作
- 可以从剪贴板粘贴文件列表（支持文本格式或文件拖放列表格式）
- 支持排除选中的文件，方便批量移除不需要的文件
